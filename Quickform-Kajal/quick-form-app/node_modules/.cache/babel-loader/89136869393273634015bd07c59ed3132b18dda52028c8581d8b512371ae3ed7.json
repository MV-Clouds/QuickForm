{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const[org,setOrg]=useState('');// Store selected Salesforce org\nconst[isButtonDisabled,setIsButtonDisabled]=useState(true);// Track login button state\nconst navigate=useNavigate();// React Router navigation\nlet popup=null;// Reference to popup window\n// Check if already logged in on mount\nuseEffect(()=>{const isLoggedIn=sessionStorage.getItem('isLoggedIn')==='true';// Check login flag\nif(isLoggedIn){navigate('/home');// Redirect to home if already logged in\n}// Add message event listener\nconst handleMessage=event=>{if(event.origin==='https://d2bri1qui9cr5s.cloudfront.net'){if(event.data.type==='login_error'){if(popup&&!popup.closed){popup.close();// Close popup on error\n}}}if(event.origin==='https://vm6pandneg.execute-api.us-east-1.amazonaws.com'){if(event.data.type==='login_success'){if(popup&&!popup.closed){popup.close();// Close popup on success\n}sessionStorage.removeItem('org');// Clear stored org\nsessionStorage.setItem('isLoggedIn','true');// Set login flag\nsessionStorage.setItem('userId',event.data.userId);// Store userId\nsessionStorage.setItem('instanceUrl',event.data.instanceUrl);// Store instanceUrl\nnavigate('/home');// Redirect to home\n}else if(event.data==='login_failed'){alert('Login failed. Please try again.');// Show error\n}}};window.addEventListener('message',handleMessage);// Add event listener\n// Clean up event listener on unmount\nreturn()=>{window.removeEventListener('message',handleMessage);// Remove event listener\n};},[navigate]);const handleOrgChange=e=>{const selectedOrg=e.target.value;// Get selected org\nsetOrg(selectedOrg);// Update state\nsetIsButtonDisabled(!selectedOrg);// Enable button if org selected\n};const openPopup=()=>{if(!org)return;// Do nothing if org not selected\nlet base='https://d2bri1qui9cr5s.cloudfront.net/auth/login';// Base login URL\nconst isLoggedIn=sessionStorage.getItem('isLoggedIn')==='true';// Check login status\nif(isLoggedIn){base+='.html';// Append .html if already logged in\n}const loginUrl=\"\".concat(base,\"?org=\").concat(org);// Construct full login URL\nsessionStorage.setItem('org',org);// Store selected org\nconst width=600,height=700;// Popup dimensions\nconst left=window.screenX+(window.innerWidth-width)/2;// Center horizontally\nconst top=window.screenY+(window.innerHeight-height)/2;// Center vertically\nconst popupWindow=window.open(loginUrl,'SalesforceLogin',\"width=\".concat(width,\",height=\").concat(height,\",left=\").concat(left,\",top=\").concat(top,\",status=no,toolbar=no,menubar=no\"));// Open popup window\nif(!popupWindow){alert('Popup was blocked. Please allow popups for this site.');// Show error if popup blocked\nreturn;}popup=popupWindow;// Store popup reference\nif(isLoggedIn){if(popup&&!popup.closed){popup.close();// Close popup immediately if already logged in\n}navigate('/home');// Redirect to home\n}};return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen bg-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-lg shadow-lg w-full max-w-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-6\",children:/*#__PURE__*/_jsx(\"img\",{src:\"https://login.salesforce.com/img/logo214.svg\",alt:\"Salesforce\",style:{height:'60px'}// Logo size\n})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-center mb-6\",children:\"Login with Salesforce\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"org-select\",className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Choose Salesforce Org\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"org-select\",value:org,onChange:handleOrgChange,className:\"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Select --\"}),\" \",/*#__PURE__*/_jsx(\"option\",{value:\"production\",children:\"Production (login.salesforce.com)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"sandbox\",children:\"Sandbox (test.salesforce.com)\"})]})]}),/*#__PURE__*/_jsx(\"button\",{id:\"login-button\",onClick:openPopup,disabled:isButtonDisabled// Disable if no org selected\n,className:\"w-full py-3 rounded-lg font-medium transition-colors \".concat(isButtonDisabled?'bg-gray-300 text-gray-500 cursor-not-allowed'// Disabled styling\n:'bg-blue-600 text-white hover:bg-blue-700'// Enabled styling\n),children:\"Login with Salesforce\"})]})});};export default Login;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","Login","org","setOrg","isButtonDisabled","setIsButtonDisabled","navigate","popup","isLoggedIn","sessionStorage","getItem","handleMessage","event","origin","data","type","closed","close","removeItem","setItem","userId","instanceUrl","alert","window","addEventListener","removeEventListener","handleOrgChange","e","selectedOrg","target","value","openPopup","base","loginUrl","concat","width","height","left","screenX","innerWidth","top","screenY","innerHeight","popupWindow","open","className","children","src","alt","style","htmlFor","id","onChange","onClick","disabled"],"sources":["C:/Users/MVclouds/Desktop/QuickForm/Merged Mapping QF/QuickForm/QuickForm-Romit-Kajal-Merge/quick-form-app/src/components/login-page/login.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst Login = () => {\r\n  const [org, setOrg] = useState(''); // Store selected Salesforce org\r\n  const [isButtonDisabled, setIsButtonDisabled] = useState(true); // Track login button state\r\n  const navigate = useNavigate(); // React Router navigation\r\n  let popup = null; // Reference to popup window\r\n\r\n  // Check if already logged in on mount\r\n  useEffect(() => {\r\n    const isLoggedIn = sessionStorage.getItem('isLoggedIn') === 'true'; // Check login flag\r\n    if (isLoggedIn) {\r\n      navigate('/home'); // Redirect to home if already logged in\r\n    }\r\n\r\n    // Add message event listener\r\n    const handleMessage = (event) => {\r\n      if (event.origin === 'https://d2bri1qui9cr5s.cloudfront.net') {\r\n        if (event.data.type === 'login_error') {\r\n          if (popup && !popup.closed) {\r\n            popup.close(); // Close popup on error\r\n          }\r\n        }\r\n      }\r\n      if (event.origin === 'https://vm6pandneg.execute-api.us-east-1.amazonaws.com') {\r\n        if (event.data.type === 'login_success') {\r\n          if (popup && !popup.closed) {\r\n            popup.close(); // Close popup on success\r\n          }\r\n          sessionStorage.removeItem('org'); // Clear stored org\r\n          sessionStorage.setItem('isLoggedIn', 'true'); // Set login flag\r\n          sessionStorage.setItem('userId', event.data.userId); // Store userId\r\n          sessionStorage.setItem('instanceUrl', event.data.instanceUrl); // Store instanceUrl\r\n          navigate('/home'); // Redirect to home\r\n        } else if (event.data === 'login_failed') {\r\n          alert('Login failed. Please try again.'); // Show error\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener('message', handleMessage); // Add event listener\r\n\r\n    // Clean up event listener on unmount\r\n    return () => {\r\n      window.removeEventListener('message', handleMessage); // Remove event listener\r\n    };\r\n  }, [navigate]);\r\n\r\n  const handleOrgChange = (e) => {\r\n    const selectedOrg = e.target.value; // Get selected org\r\n    setOrg(selectedOrg); // Update state\r\n    setIsButtonDisabled(!selectedOrg); // Enable button if org selected\r\n  };\r\n\r\n  const openPopup = () => {\r\n    if (!org) return; // Do nothing if org not selected\r\n\r\n    let base = 'https://d2bri1qui9cr5s.cloudfront.net/auth/login'; // Base login URL\r\n    const isLoggedIn = sessionStorage.getItem('isLoggedIn') === 'true'; // Check login status\r\n\r\n    if (isLoggedIn) {\r\n      base += '.html'; // Append .html if already logged in\r\n    }\r\n\r\n    const loginUrl = `${base}?org=${org}`; // Construct full login URL\r\n    sessionStorage.setItem('org', org); // Store selected org\r\n\r\n    const width = 600, height = 700; // Popup dimensions\r\n    const left = window.screenX + (window.innerWidth - width) / 2; // Center horizontally\r\n    const top = window.screenY + (window.innerHeight - height) / 2; // Center vertically\r\n\r\n    const popupWindow = window.open(\r\n      loginUrl,\r\n      'SalesforceLogin',\r\n      `width=${width},height=${height},left=${left},top=${top},status=no,toolbar=no,menubar=no`\r\n    ); // Open popup window\r\n\r\n    if (!popupWindow) {\r\n      alert('Popup was blocked. Please allow popups for this site.'); // Show error if popup blocked\r\n      return;\r\n    }\r\n\r\n    popup = popupWindow; // Store popup reference\r\n\r\n    if (isLoggedIn) {\r\n      if (popup && !popup.closed) {\r\n        popup.close(); // Close popup immediately if already logged in\r\n      }\r\n      navigate('/home'); // Redirect to home\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-center min-h-screen bg-gray-100\">\r\n      <div className=\"bg-white p-8 rounded-lg shadow-lg w-full max-w-sm\">\r\n        <div className=\"flex justify-center mb-6\">\r\n          <img\r\n            src=\"https://login.salesforce.com/img/logo214.svg\"\r\n            alt=\"Salesforce\"\r\n            style={{ height: '60px' }} // Logo size\r\n          />\r\n        </div>\r\n        <h2 className=\"text-2xl font-bold text-center mb-6\">Login with Salesforce</h2>\r\n        <div className=\"mb-4\">\r\n          <label htmlFor=\"org-select\" className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n            Choose Salesforce Org\r\n          </label>\r\n          <select\r\n            id=\"org-select\"\r\n            value={org}\r\n            onChange={handleOrgChange}\r\n            className=\"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          >\r\n            <option value=\"\">-- Select --</option> {/* Placeholder option */}\r\n            <option value=\"production\">Production (login.salesforce.com)</option>\r\n            <option value=\"sandbox\">Sandbox (test.salesforce.com)</option>\r\n          </select>\r\n        </div>\r\n        <button\r\n          id=\"login-button\"\r\n          onClick={openPopup}\r\n          disabled={isButtonDisabled} // Disable if no org selected\r\n          className={`w-full py-3 rounded-lg font-medium transition-colors ${\r\n            isButtonDisabled\r\n              ? 'bg-gray-300 text-gray-500 cursor-not-allowed' // Disabled styling\r\n              : 'bg-blue-600 text-white hover:bg-blue-700' // Enabled styling\r\n          }`}\r\n        >\r\n          Login with Salesforce\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}