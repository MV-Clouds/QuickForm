{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FormName=_ref=>{let{onClose,fields=[],selectedObjects,selectedFields,fieldsData}=_ref;const[formName,setFormName]=useState('');const[formNameError,setFormNameError]=useState(null);const[isSaving,setIsSaving]=useState(false);const navigate=useNavigate();const fetchAccessToken=async(userId,instanceUrl)=>{try{const response=await fetch(process.env.REACT_APP_GET_ACCESS_TOKEN_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,instanceUrl})});const data=await response.json();if(!response.ok){throw new Error(data.error||'Failed to fetch access token');}return data.access_token;}catch(error){console.error('Error fetching access token:',error);return null;}};const prepareFormData=()=>{const headerField=fields.find(f=>f.type==='header')||{id:'default-header',type:'header',heading:formName,alignment:'center'};const nonHeaderFields=fields.filter(f=>f.type!=='header');const pages=[];let currentPage=[];let pageNumber=1;nonHeaderFields.forEach(field=>{if(field.type==='pagebreak'){pages.push({fields:currentPage,pageNumber});pageNumber++;currentPage=[];}else{currentPage.push(field);}});if(currentPage.length>0||pages.length===0){pages.push({fields:currentPage,pageNumber});}const formVersion={Name:formName,Description__c:'',Stage__c:'Draft',Publish_Link__c:'',Version__c:'1'};const formFields=pages.flatMap(page=>page.fields.map((field,index)=>({Name:field.label||field.type.charAt(0).toUpperCase()+field.type.slice(1),Field_Type__c:field.type,Page_Number__c:page.pageNumber,Order_Number__c:index+1,Properties__c:JSON.stringify(field),Unique_Key__c:field.id})));return{formVersion,formFields};};const handleFormNameSubmit=async()=>{if(!formName.trim()){setFormNameError('Form name is required.');return;}setIsSaving(true);setFormNameError(null);try{const userId=sessionStorage.getItem('userId');const instanceUrl=sessionStorage.getItem('instanceUrl');if(!userId||!instanceUrl){throw new Error('Missing userId or instanceUrl. Please log in.');}const token=await fetchAccessToken(userId,instanceUrl);if(!token)throw new Error('Failed to obtain access token.');const{formVersion,formFields}=prepareFormData();const response=await fetch(process.env.REACT_APP_SAVE_FORM_URL,{method:'POST',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(token)},body:JSON.stringify({userId,instanceUrl:instanceUrl.replace(/https?:\\/\\//,''),formData:{formVersion,formFields}})});const data=await response.json();if(!response.ok)throw new Error(data.error||'Failed to create form.');const newFormVersionId=data.formVersionId;navigate(\"/form-builder/\".concat(newFormVersionId),{state:{selectedObjects,selectedFields,fieldsData}});}catch(error){console.error('Error creating form:',error);setFormNameError(error.message||'Failed to create form.');}finally{setIsSaving(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold\",children:\"Enter Form Name\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-gray-500 hover:text-gray-700\",\"aria-label\":\"Close\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formName,onChange:e=>setFormName(e.target.value),placeholder:\"Form Name\",className:\"w-full p-2 border rounded-md mb-4\"}),formNameError&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm mb-4\",children:formNameError}),/*#__PURE__*/_jsx(\"button\",{onClick:handleFormNameSubmit,disabled:isSaving,className:\"w-full p-2 bg-blue-600 text-white rounded-md \".concat(isSaving?'opacity-50 cursor-not-allowed':'hover:bg-blue-700'),children:isSaving?'Creating...':'Create Form'})]})});};export default FormName;","map":{"version":3,"names":["React","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","FormName","_ref","onClose","fields","selectedObjects","selectedFields","fieldsData","formName","setFormName","formNameError","setFormNameError","isSaving","setIsSaving","navigate","fetchAccessToken","userId","instanceUrl","response","fetch","process","env","REACT_APP_GET_ACCESS_TOKEN_URL","method","headers","body","JSON","stringify","data","json","ok","Error","error","access_token","console","prepareFormData","headerField","find","f","type","id","heading","alignment","nonHeaderFields","filter","pages","currentPage","pageNumber","forEach","field","push","length","formVersion","Name","Description__c","Stage__c","Publish_Link__c","Version__c","formFields","flatMap","page","map","index","label","charAt","toUpperCase","slice","Field_Type__c","Page_Number__c","Order_Number__c","Properties__c","Unique_Key__c","handleFormNameSubmit","trim","sessionStorage","getItem","token","REACT_APP_SAVE_FORM_URL","Authorization","concat","replace","formData","newFormVersionId","formVersionId","state","message","className","children","onClick","value","onChange","e","target","placeholder","disabled"],"sources":["C:/Users/MVclouds/Desktop/QuickForm/Merged Mapping QF/QuickForm/QuickForm-Romit-Kajal-Merge/quick-form-app/src/components/create-form-wizard/FormName.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst FormName = ({ onClose, fields = [],selectedObjects, selectedFields, fieldsData }) => {\r\n  const [formName, setFormName] = useState('');\r\n  const [formNameError, setFormNameError] = useState(null);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  const fetchAccessToken = async (userId, instanceUrl) => {\r\n    try {\r\n      const response = await fetch(process.env.REACT_APP_GET_ACCESS_TOKEN_URL, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          userId,\r\n          instanceUrl,\r\n        }),\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to fetch access token');\r\n      }\r\n      return data.access_token;\r\n    } catch (error) {\r\n      console.error('Error fetching access token:', error);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const prepareFormData = () => {\r\n    const headerField = fields.find((f) => f.type === 'header') || {\r\n      id: 'default-header',\r\n      type: 'header',\r\n      heading: formName,\r\n      alignment: 'center',\r\n    };\r\n    const nonHeaderFields = fields.filter((f) => f.type !== 'header');\r\n    const pages = [];\r\n    let currentPage = [];\r\n    let pageNumber = 1;\r\n    nonHeaderFields.forEach((field) => {\r\n      if (field.type === 'pagebreak') {\r\n        pages.push({ fields: currentPage, pageNumber });\r\n        pageNumber++;\r\n        currentPage = [];\r\n      } else {\r\n        currentPage.push(field);\r\n      }\r\n    });\r\n    if (currentPage.length > 0 || pages.length === 0) {\r\n      pages.push({ fields: currentPage, pageNumber });\r\n    }\r\n    const formVersion = {\r\n      Name: formName,\r\n      Description__c: '',\r\n      Stage__c: 'Draft',\r\n      Publish_Link__c: '',\r\n      Version__c: '1',\r\n    };\r\n    const formFields = pages.flatMap((page) =>\r\n      page.fields.map((field, index) => ({\r\n        Name: field.label || field.type.charAt(0).toUpperCase() + field.type.slice(1),\r\n        Field_Type__c: field.type,\r\n        Page_Number__c: page.pageNumber,\r\n        Order_Number__c: index + 1,\r\n        Properties__c: JSON.stringify(field),\r\n        Unique_Key__c: field.id,\r\n      }))\r\n    );\r\n    return { formVersion, formFields };\r\n  };\r\n\r\n  const handleFormNameSubmit = async () => {\r\n    if (!formName.trim()) {\r\n      setFormNameError('Form name is required.');\r\n      return;\r\n    }\r\n    setIsSaving(true);\r\n    setFormNameError(null);\r\n    try {\r\n      const userId = sessionStorage.getItem('userId');\r\n      const instanceUrl = sessionStorage.getItem('instanceUrl');\r\n      if (!userId || !instanceUrl) {\r\n        throw new Error('Missing userId or instanceUrl. Please log in.');\r\n      }\r\n      const token = await fetchAccessToken(userId, instanceUrl);\r\n      if (!token) throw new Error('Failed to obtain access token.');\r\n      const { formVersion, formFields } = prepareFormData();\r\n      const response = await fetch(process.env.REACT_APP_SAVE_FORM_URL, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({\r\n          userId,\r\n          instanceUrl: instanceUrl.replace(/https?:\\/\\//, ''),\r\n          formData: { formVersion, formFields },\r\n        }),\r\n      });\r\n      const data = await response.json();\r\n      if (!response.ok) throw new Error(data.error || 'Failed to create form.');\r\n      const newFormVersionId = data.formVersionId;\r\n      navigate(`/form-builder/${newFormVersionId}`, {\r\n        state: {\r\n          selectedObjects,\r\n          selectedFields,\r\n          fieldsData,\r\n        },\r\n      });\r\n    } catch (error) {\r\n      console.error('Error creating form:', error);\r\n      setFormNameError(error.message || 'Failed to create form.');\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\r\n        <div className=\"flex justify-between items-center mb-4\">\r\n          <h2 className=\"text-xl font-bold\">Enter Form Name</h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700\"\r\n            aria-label=\"Close\"\r\n          >\r\n            Ã—\r\n          </button>\r\n        </div>\r\n        <input\r\n          type=\"text\"\r\n          value={formName}\r\n          onChange={(e) => setFormName(e.target.value)}\r\n          placeholder=\"Form Name\"\r\n          className=\"w-full p-2 border rounded-md mb-4\"\r\n        />\r\n        {formNameError && <p className=\"text-red-500 text-sm mb-4\">{formNameError}</p>}\r\n        <button\r\n          onClick={handleFormNameSubmit}\r\n          disabled={isSaving}\r\n          className={`w-full p-2 bg-blue-600 text-white rounded-md ${\r\n            isSaving ? 'opacity-50 cursor-not-allowed' : 'hover:bg-blue-700'\r\n          }`}\r\n        >\r\n          {isSaving ? 'Creating...' : 'Create Form'}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FormName;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}